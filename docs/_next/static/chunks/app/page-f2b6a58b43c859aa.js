(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5642:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var a=n(5155),r=n(4520),i=n(4935),s=n(4045),l=n(2139),u=n(2115),d=n(556),o=n(9941),c=n(3195),m=n(7417),p=n(6369),y=n(161),h=n(4710),f=n(8245);let b=[{type:"constructor",inputs:[{name:"_feeReceiver",type:"address"}],stateMutability:"nonpayable"},{type:"function",name:"ACTION_COOLDOWN",inputs:[],outputs:[{name:"",type:"uint256"}],stateMutability:"view"},{type:"function",name:"FEE_BPS",inputs:[],outputs:[{name:"",type:"uint256"}],stateMutability:"view"},{type:"function",name:"MAX_ATTEMPTS",inputs:[],outputs:[{name:"",type:"uint8"}],stateMutability:"view"},{type:"function",name:"attemptsUsed",inputs:[{name:"roundId",type:"uint256"},{name:"player",type:"address"}],outputs:[{name:"",type:"uint8"}],stateMutability:"view"},{type:"function",name:"currentAttemptScore",inputs:[{name:"roundId",type:"uint256"},{name:"player",type:"address"}],outputs:[{name:"",type:"uint256"}],stateMutability:"view"},{type:"function",name:"totalScore",inputs:[{name:"roundId",type:"uint256"},{name:"player",type:"address"}],outputs:[{name:"",type:"uint256"}],stateMutability:"view"},{type:"function",name:"startAttempt",inputs:[{name:"roundId",type:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"endAttempt",inputs:[{name:"roundId",type:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"createRound",inputs:[{name:"entryFee",type:"uint256"},{name:"duration",type:"uint256"}],outputs:[{name:"roundId",type:"uint256"}],stateMutability:"nonpayable"},{type:"function",name:"finalizeRound",inputs:[{name:"roundId",type:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"getPlayers",inputs:[{name:"roundId",type:"uint256"}],outputs:[{name:"",type:"address[]"}],stateMutability:"view"},{type:"function",name:"getScore",inputs:[{name:"roundId",type:"uint256"},{name:"player",type:"address"}],outputs:[{name:"",type:"uint256"}],stateMutability:"view"},{type:"function",name:"joinRound",inputs:[{name:"roundId",type:"uint256"}],outputs:[],stateMutability:"payable"},{type:"function",name:"joined",inputs:[{name:"",type:"uint256"},{name:"",type:"address"}],outputs:[{name:"",type:"bool"}],stateMutability:"view"},{type:"function",name:"nextRoundId",inputs:[],outputs:[{name:"",type:"uint256"}],stateMutability:"view"},{type:"function",name:"rounds",inputs:[{name:"",type:"uint256"}],outputs:[{name:"creator",type:"address"},{name:"entryFee",type:"uint256"},{name:"startTime",type:"uint256"},{name:"endTime",type:"uint256"},{name:"pool",type:"uint256"},{name:"finalized",type:"bool"},{name:"playerCount",type:"uint256"}],stateMutability:"view"},{type:"function",name:"submitAction",inputs:[{name:"roundId",type:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"submitActions",inputs:[{name:"roundId",type:"uint256"},{name:"amount",type:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"event",name:"AttemptStarted",inputs:[{name:"roundId",type:"uint256",indexed:!0},{name:"player",type:"address",indexed:!0},{name:"attemptNumber",type:"uint8",indexed:!1}]},{type:"event",name:"AttemptEnded",inputs:[{name:"roundId",type:"uint256",indexed:!0},{name:"player",type:"address",indexed:!0},{name:"attemptsUsed",type:"uint8",indexed:!1},{name:"attemptScore",type:"uint256",indexed:!1},{name:"totalScore",type:"uint256",indexed:!1}]},{type:"event",name:"ActionsSubmitted",inputs:[{name:"roundId",type:"uint256",indexed:!0},{name:"player",type:"address",indexed:!0},{name:"amount",type:"uint256",indexed:!1},{name:"newScore",type:"uint256",indexed:!1}]},{type:"event",name:"ActionSubmitted",inputs:[{name:"roundId",type:"uint256",indexed:!0},{name:"player",type:"address",indexed:!0},{name:"newScore",type:"uint256",indexed:!1}]},{type:"event",name:"RoundCreated",inputs:[{name:"roundId",type:"uint256",indexed:!0},{name:"creator",type:"address",indexed:!0},{name:"entryFee",type:"uint256",indexed:!1},{name:"startTime",type:"uint256",indexed:!1},{name:"endTime",type:"uint256",indexed:!1}]},{type:"event",name:"RoundFinalized",inputs:[{name:"roundId",type:"uint256",indexed:!0},{name:"winner",type:"address",indexed:!0},{name:"payout",type:"uint256",indexed:!1},{name:"fee",type:"uint256",indexed:!1}]},{type:"event",name:"RoundJoined",inputs:[{name:"roundId",type:"uint256",indexed:!0},{name:"player",type:"address",indexed:!0}]}],x="0x5258b89e2550E317499F14A0750aEE236152D791";function g(e){let{active:t,onDistance:n,onCrash:r}=e,i=(0,u.useRef)(null),s=(0,u.useRef)(null),[l,d]=(0,u.useState)("ready"),o=(0,u.useRef)("ready"),[c,m]=(0,u.useState)(0),p=(0,u.useRef)({y:0,vy:0,slidingUntil:0,dashingUntil:0}),y=(0,u.useRef)([]),h=(0,u.useRef)(!1),f=(0,u.useMemo)(()=>({gravity:2400,jumpVy:-820,speed:320,speedRamp:4,obstacleEvery:1.05,obstacleW:34,runnerX:82,runnerW:22,runnerH:34,runnerSlideH:18,groundPad:24,slideMs:420,dashMs:220,holdToSlideMs:180}),[]);function b(){p.current={y:0,vy:0,slidingUntil:0,dashingUntil:0},y.current=[],m(0),h.current=!1,o.current="ready",d("ready")}function x(){t&&"ready"===o.current&&(o.current="running",d("running"))}(0,u.useEffect)(()=>{if(!t)return void b();b(),o.current="running",d("running")},[t]),(0,u.useEffect)(()=>{if(!t){s.current&&cancelAnimationFrame(s.current),s.current=null,o.current="ready",d("ready");return}let e=i.current;if(!e)return;let a=e.getContext("2d");if(!a)return;let l=performance.now(),u=0,b=f.speed,x=()=>{let t=Math.max(1,Math.floor(window.devicePixelRatio||1)),{width:n,height:r}=e.getBoundingClientRect();e.width=Math.floor(n*t),e.height=Math.floor(r*t),a.setTransform(t,0,0,t,0,0);let i=r-f.groundPad;0===p.current.y&&(p.current.y=i)};x(),window.addEventListener("resize",x);let g=t=>{let i=Math.min(.033,(t-l)/1e3);if(l=t,"running"===o.current){b+=f.speedRamp*i;let t=e.clientWidth,a=e.clientHeight-f.groundPad;if(p.current.vy+=f.gravity*i,p.current.y+=p.current.vy*i,p.current.y>a&&(p.current.y=a,p.current.vy=0),(u+=i)>=f.obstacleEvery){u=0;let e=.6>Math.random()?"low":"high";y.current.push({x:t+40,w:f.obstacleW,h:"low"===e?26:44,kind:e})}for(let e of y.current)e.x-=b*i;y.current=y.current.filter(e=>e.x>-e.w-20);let s=b*i;m(e=>e+s),n(s/10),(()=>{let t=e.clientWidth,n=e.clientHeight;if(!t||!n)return!1;let a=n-f.groundPad,r=performance.now(),i=r<p.current.slidingUntil,s=r<p.current.dashingUntil,l=f.runnerX,u=f.runnerW,d=i?f.runnerSlideH:f.runnerH,o=p.current.y-d,c=6*!!s;for(let e of y.current){let t=e.x,n=a-e.h,r=e.w,i=e.h;if(l+c<t+r&&l+u-c>t&&o+c<n+i&&o+d-c>n)return!0}return!1})()&&(o.current="crashed",d("crashed"),h.current||(h.current=!0,null==r||r()))}(()=>{let t=e.clientWidth,n=e.clientHeight,r=n-f.groundPad;a.fillStyle="#070a12",a.fillRect(0,0,t,n),a.fillStyle="rgba(255,255,255,0.03)";for(let e=0;e<n;e+=4)a.fillRect(0,e,t,1);a.strokeStyle="rgba(34,211,238,0.18)",a.lineWidth=1;for(let e=0;e<t;e+=28)a.beginPath(),a.moveTo(e-.6*c%28,r),a.lineTo(e-.6*c%28,n),a.stroke();let i=a.createLinearGradient(0,r,0,n);for(let e of(i.addColorStop(0,"rgba(34,211,238,0.18)"),i.addColorStop(1,"rgba(0,0,0,0.0)"),a.fillStyle=i,a.fillRect(0,r,t,n-r),y.current)){let t=r-e.h;if(a.save(),a.lineWidth=2,a.strokeStyle="rgba(0,0,0,0.75)","low"===e.kind){let n=e.w/4;a.beginPath(),a.moveTo(e.x,r);for(let i=0;i<4;i++){let s=e.x+i*n;a.lineTo(s+n/2,t),a.lineTo(s+n,r)}a.closePath(),a.fillStyle="#fbbf24",a.fill(),a.stroke(),a.shadowColor="rgba(251,191,36,0.75)",a.shadowBlur=12,a.fill()}else a.fillStyle="#22d3ee",a.fillRect(e.x,t,e.w,e.h),a.strokeRect(e.x,t,e.w,e.h),a.shadowColor="rgba(34,211,238,0.8)",a.shadowBlur=14,a.fillRect(e.x,t,e.w,e.h);a.restore()}let s=performance.now()<p.current.slidingUntil,l=f.runnerW,u=s?f.runnerSlideH:f.runnerH,d=f.runnerX,m=p.current.y-u,h=d+l/2,b=m+u/2,x=Math.max(10,Math.min(l,u)/2);a.save(),a.beginPath(),a.arc(h,b,x,0,2*Math.PI),a.closePath(),a.fillStyle="#ffd6ff",a.shadowColor="rgba(255,43,214,0.75)",a.shadowBlur=16,a.fill(),a.shadowBlur=0,a.lineWidth=2,a.strokeStyle="rgba(255,43,214,0.95)",a.stroke(),a.fillStyle="rgba(0,0,0,0.75)",a.beginPath(),a.arc(h-.35*x,b-.15*x,Math.max(1.8,.12*x),0,2*Math.PI),a.arc(h+.05*x,b-.15*x,Math.max(1.8,.12*x),0,2*Math.PI),a.fill(),a.fillStyle="rgba(255,43,214,0.35)",a.beginPath(),a.arc(h-.45*x,b+.1*x,Math.max(2.2,.16*x),0,2*Math.PI),a.fill(),s&&(a.strokeStyle="rgba(255,255,255,0.55)",a.lineWidth=2,a.beginPath(),a.moveTo(d-10,p.current.y-2),a.lineTo(d+l+18,p.current.y-2),a.stroke()),a.restore(),a.fillStyle="rgba(255,255,255,0.85)",a.font="600 14px ui-monospace, SFMono-Regular, Menlo, monospace","ready"===o.current?a.fillText("Tap to JUMP • hold to SLIDE",14,22):"crashed"===o.current&&a.fillText("CRASHED",14,22);let g=a.createRadialGradient(t/2,n/2,.2*Math.min(t,n),t/2,n/2,.75*Math.max(t,n));g.addColorStop(0,"rgba(0,0,0,0)"),g.addColorStop(1,"rgba(0,0,0,0.55)"),a.fillStyle=g,a.fillRect(0,0,t,n)})(),s.current=requestAnimationFrame(g)};return s.current=requestAnimationFrame(g),()=>{s.current&&cancelAnimationFrame(s.current),s.current=null,window.removeEventListener("resize",x)}},[t,f,n,r]);let g=(0,u.useRef)(null),v=(0,u.useRef)(0),w=(0,u.useRef)(!1),S=()=>{g.current&&window.clearTimeout(g.current),g.current=null};return(0,a.jsx)("div",{className:"dash-root",onPointerDown:e=>{e.preventDefault(),t&&"crashed"!==o.current&&(v.current=Date.now(),w.current=!1,S(),g.current=window.setTimeout(()=>{w.current=!0,function(e){if(t&&(x(),"running"===o.current)){if(e<p.current.slidingUntil){p.current.dashingUntil=e+f.dashMs;return}p.current.slidingUntil=e+f.slideMs}}(Date.now())},f.holdToSlideMs))},onPointerUp:e=>{if(e.preventDefault(),!t||(S(),"crashed"===o.current))return;let n=Date.now()-v.current;w.current||n>=f.holdToSlideMs||function(){var e,n;if(!t||(x(),"running"!==o.current))return;let a=null!=(n=null==(e=i.current)?void 0:e.clientHeight)?n:0;if(!a)return;let r=a-f.groundPad;.01>Math.abs(p.current.y-r)&&(p.current.vy=f.jumpVy)}()},onPointerCancel:()=>{S()},onContextMenu:e=>e.preventDefault(),children:(0,a.jsx)("canvas",{ref:i,className:"dash-canvas"})})}function v(e){let{address:t,demo:n}=e,r=!!n,[i,s]=(0,u.useState)(null),[l,v]=(0,u.useState)([]),[w,S]=(0,u.useState)(0),[N,j]=(0,u.useState)(0n),[M,C]=(0,u.useState)(!1),[I,R]=(0,u.useState)(0),[E,T]=(0,u.useState)(0n),[k,A]=(0,u.useState)(0n),[P,D]=(0,u.useState)(!1),[B,F]=(0,u.useState)(!1),L=(0,d.e)(),H=(0,o.i)(),{switchChainAsync:U}=(0,c.R)(),{writeContractAsync:W,isPending:z}=(0,m.x)(),[_,q]=(0,u.useState)(!1),[O,J]=(0,u.useState)(null),[Q,X]=(0,u.useState)(!1),[G]=(0,u.useState)(.01),[V,Y]=(0,u.useState)(0),[K,Z]=(0,u.useState)([]),[$,ee]=(0,u.useState)(0),[et,en]=(0,u.useState)(0n),[ea,er]=(0,u.useState)(0n);(0,u.useEffect)(()=>{if(!r||null!==O)return;let e=Math.floor(Date.now()/1e3);s(0n),J(e+120),Z([t,"0x000000000000000000000000000000000000dEaD","0x000000000000000000000000000000000000bEEF"]),v([{address:t,score:0n},{address:"0x000000000000000000000000000000000000dEaD",score:3n},{address:"0x000000000000000000000000000000000000bEEF",score:1n}]),Y(.03),q(!0),ee(0),en(0n),er(0n),D(!1),j(0n)},[r,O,t]),(0,u.useEffect)(()=>{if(!r||!O)return;let e=()=>{S(Math.max(0,O-Math.floor(Date.now()/1e3)))};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[r,O]),(0,u.useEffect)(()=>{if(!r||Q)return;let e=setInterval(()=>{v(e=>{let n=e.map(e=>({...e}));for(let e of n)e.address.toLowerCase()!==t.toLowerCase()&&.55>Math.random()&&(e.score=e.score+1n);return n.sort((e,t)=>t.score>e.score?1:t.score<e.score?-1:0),n})},2500);return()=>clearInterval(e)},[r,Q,t]);let{data:ei,refetch:es}=(0,p.Q)({address:x,abi:b,functionName:"nextRoundId",query:{enabled:!r}});(0,u.useEffect)(()=>{!r&&void 0!==ei&&ei>0n&&s(ei-1n)},[ei,r]);let{data:el,refetch:eu}=(0,p.Q)({address:x,abi:b,functionName:"rounds",args:null!==i?[i]:void 0,query:{enabled:!r&&null!==i}}),{data:ed,refetch:eo}=(0,p.Q)({address:x,abi:b,functionName:"joined",args:null!==i?[i,t]:void 0,query:{enabled:!r&&null!==i}}),{data:ec,refetch:em}=(0,p.Q)({address:x,abi:b,functionName:"attemptsUsed",args:null!==i?[i,t]:void 0,query:{enabled:!r&&null!==i}}),{data:ep,refetch:ey}=(0,p.Q)({address:x,abi:b,functionName:"currentAttemptScore",args:null!==i?[i,t]:void 0,query:{enabled:!r&&null!==i}}),{data:eh,refetch:ef}=(0,p.Q)({address:x,abi:b,functionName:"totalScore",args:null!==i?[i,t]:void 0,query:{enabled:!r&&null!==i}}),[eb,ex,eg,ev,ew,eS,eN]=null!=el?el:[void 0,0n,0n,0n,0n,!1,0n],ej=O?BigInt(O):0n,eM=r?ej:null!=ev?ev:0n,eC=r?Q:null!=eS&&eS,eI=r?(0,h.g)(G.toString()):null!=ex?ex:0n,eR=r?(0,h.g)(V.toString()):null!=ew?ew:0n,eE=r?BigInt(K.length):null!=eN?eN:0n,eT=r?_:null!=ed&&ed,ek=BigInt(Math.floor(Date.now()/1e3)),eA=eM>0n&&ek<eM&&!eC,eP=eM>0n&&ek>=eM;(0,u.useEffect)(()=>{if(!eA){D(!1),F(!1);return}r?(R($),T(et),A(ea+et)):(R(Number(null!=ec?ec:0)),T(null!=ep?ep:0n),A(null!=eh?eh:0n))},[eA,r,$,et,ea,ec,ep,eh]),(0,u.useEffect)(()=>{if(r||!ev||0n===ev)return;let e=()=>{S(Math.max(0,Number(ev)-Math.floor(Date.now()/1e3)))};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[ev,r]);let eD=(0,u.useCallback)(async()=>{if(!r&&null!==i&&L)try{let e=await L.readContract({address:x,abi:b,functionName:"getPlayers",args:[i]}),n=await Promise.all(e.map(async e=>{let t=await L.readContract({address:x,abi:b,functionName:"getScore",args:[i,e]});return{address:e,score:t}}));n.sort((e,t)=>t.score>e.score?1:t.score<e.score?-1:0),v(n);let a=n.find(e=>e.address.toLowerCase()===t.toLowerCase());a&&j(a.score)}catch(e){}},[i,L,t,r]);(0,u.useEffect)(()=>{eD()},[eD]),(0,u.useEffect)(()=>{if(r||!eA)return;let e=setInterval(eD,3e3);return()=>clearInterval(e)},[eA,eD,r]),(0,y.x)({address:x,abi:b,eventName:"ActionsSubmitted",enabled:!r,onLogs(){eD(),em(),ey(),ef()}}),(0,y.x)({address:x,abi:b,eventName:"AttemptEnded",enabled:!r,onLogs(){em(),ey(),ef(),eD()}});let eB=(0,u.useRef)(0),eF=(0,u.useRef)(null),eL=(0,u.useRef)(0),eH=eA&&eT&&!P&&I<3&&!B,eU=(0,u.useCallback)(async e=>{if(!eH)return;if(r){let e=Math.floor(eB.current);if(e<=0)return;eB.current-=e,en(t=>t+BigInt(e)),v(n=>{let a=n.map(e=>({...e})),r=a.findIndex(e=>e.address.toLowerCase()===t.toLowerCase());return r>=0&&(a[r].score=a[r].score+BigInt(e)),a.sort((e,t)=>t.score>e.score?1:t.score<e.score?-1:0),a});return}if(!eA||!eT||null===i||eF.current)return;let n=Date.now(),a=Math.floor(eB.current);if(a<=0)return;let s=n-eL.current;if(e||!(a<25)||!(s<3e3)){eB.current-=a,eF.current={amount:a},eL.current=n;try{await W({address:x,abi:b,functionName:"submitActions",args:[i,BigInt(a)]}),eD(),ey(),ef()}catch(e){eB.current+=a}finally{eF.current=null}}},[eH,r,eA,eT,i,W,eD,t,ey,ef]),eW=(0,u.useCallback)(e=>{eH&&(e<=0||(eB.current+=e,eU()))},[eH,eU]);(0,u.useEffect)(()=>{if(!eH)return;let e=setInterval(()=>{eU()},500);return()=>clearInterval(e)},[eH,eU]);let ez=(0,u.useCallback)(async()=>{if(eA&&eT&&!B){F(!0);try{if(await eU(!0),r)er(e=>e+et+BigInt(Math.floor(eB.current))),en(0n),eB.current=0,ee(e=>Math.min(3,e+1));else{if(null===i)return;await W({address:x,abi:b,functionName:"endAttempt",args:[i]}),em(),ey(),ef(),eD(),eB.current=0}}finally{F(!1)}}},[eA,eT,B,eU,r,et,i,W,em,ey,ef,eD]),e_=(0,u.useCallback)(async()=>{D(!0);try{await ez()}catch(e){}},[ez]);async function eq(){if(r){let e=Math.floor(Date.now()/1e3);X(!1),J(e+120),v([{address:t,score:0n},{address:"0x000000000000000000000000000000000000dEaD",score:0n},{address:"0x000000000000000000000000000000000000bEEF",score:0n}]),Y(.03),q(!0),ee(0),en(0n),er(0n),eB.current=0,D(!1),j(0n);return}await W({address:x,abi:b,functionName:"createRound",args:[(0,h.g)("0.01"),120n]}),await es()}async function eO(){if(r)return void q(!0);if(null!==i&&void 0!==ex){if(await W({address:x,abi:b,functionName:"joinRound",args:[i],value:ex}),await eo(),await eu(),eA)try{await W({address:x,abi:b,functionName:"startAttempt",args:[i]})}catch(e){}em(),ey(),ef(),eD()}}async function eJ(){if(r)return void X(!0);null!==i&&(await W({address:x,abi:b,functionName:"finalizeRound",args:[i]}),await eu(),eD())}let eQ=(0,u.useMemo)(()=>[31337,6343],[]).includes(H);if(!r&&!eQ)return(0,a.jsxs)("div",{className:"no-round",children:[(0,a.jsx)("p",{children:"Wrong network. This app isn’t deployed on your current chain."}),(0,a.jsx)("p",{style:{opacity:.8,fontSize:14},children:"Switch to Anvil (local) for now. MegaETH support will be enabled once the chain is live and we deploy the contract."}),(0,a.jsx)("button",{className:"action-btn",onClick:async()=>{try{await U({chainId:31337})}catch(e){}},children:"Switch network"})]});if(null===i||!r&&0n===ei)return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"no-round",children:(0,a.jsx)("p",{children:"No rounds yet"})}),(0,a.jsx)("button",{className:"action-btn",onClick:eq,disabled:z,children:z?"Creating...":"Create Round (0.01 ETH, 2 min)"})]});let eX=Math.min(3,I+1),eG=E+BigInt(Math.floor(eB.current)),eV=k+BigInt(Math.floor(eB.current));return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsxs)("h2",{children:["Round #",i.toString()]}),(0,a.jsx)("span",{className:"badge ".concat(eA?"badge-active":"badge-ended"),children:eC?"Finalized":eA?"Active":"Ended"})]}),(0,a.jsxs)("div",{className:"round-info",style:{marginTop:8},children:[(0,a.jsxs)("span",{children:["Entry: ",(0,f.c)(eI)," ETH"]}),(0,a.jsxs)("span",{children:["Pool: ",(0,f.c)(eR)," ETH"]}),(0,a.jsxs)("span",{children:["Players: ",eE.toString()]})]})]}),eA&&(0,a.jsxs)("div",{className:"dash-wrap",children:[(0,a.jsxs)("div",{className:"dash-hud",children:[(0,a.jsxs)("div",{className:"dash-hud-left",children:[(0,a.jsx)("div",{className:"dash-hud-label",children:"ATTEMPT"}),(0,a.jsxs)("div",{className:"dash-hud-value",children:[eX,"/",3]})]}),(0,a.jsxs)("div",{className:"dash-hud-mid",children:[(0,a.jsx)("div",{className:"dash-hud-label",children:"ATTEMPT SCORE"}),(0,a.jsx)("div",{className:"dash-hud-value",children:eG.toString()})]}),(0,a.jsxs)("div",{className:"dash-hud-right",children:[(0,a.jsx)("div",{className:"dash-hud-label",children:"TOTAL"}),(0,a.jsx)("div",{className:"dash-hud-value",children:eV.toString()})]})]}),(0,a.jsx)("button",{className:"dash-standings",onClick:()=>C(!0),children:"Standings"}),(0,a.jsx)(g,{active:eH,onDistance:eW,onCrash:e_},"attempt-".concat(I,"-").concat(P?"over":"run")),!eT&&(0,a.jsx)("div",{className:"dash-overlay",children:(0,a.jsxs)("div",{className:"dash-overlay-inner",children:[(0,a.jsx)("p",{style:{marginBottom:10,opacity:.9},children:"Join to start dashing."}),(0,a.jsx)("button",{className:"action-btn",onClick:eO,disabled:z,children:z?"Joining...":r?"Join Round (demo)":"Join Round (".concat((0,f.c)(eI)," ETH)")})]})}),eT&&I>=3&&(0,a.jsx)("div",{className:"dash-overlay",children:(0,a.jsxs)("div",{className:"dash-overlay-inner",children:[(0,a.jsx)("p",{style:{marginBottom:10,opacity:.9},children:"All attempts used."}),(0,a.jsx)("p",{style:{marginBottom:12,opacity:.75,fontSize:13},children:"Final score is the sum of your 3 attempts."})]})}),eT&&P&&I<3&&(0,a.jsx)("div",{className:"dash-overlay",children:(0,a.jsxs)("div",{className:"dash-overlay-inner",children:[(0,a.jsx)("p",{style:{marginBottom:6,fontWeight:800},children:"Attempt over"}),(0,a.jsxs)("p",{style:{marginBottom:12,opacity:.8,fontSize:13},children:["Attempt score: ",eG.toString()," • Total: ",eV.toString()]}),(0,a.jsx)("button",{className:"action-btn",onClick:async()=>{if(!r&&(null!=E?E:0n)>0n)try{await ez()}catch(e){}if(!r&&null!==i)try{await W({address:x,abi:b,functionName:"startAttempt",args:[i]}),em(),ey(),ef()}catch(e){}D(!1),eB.current=0},disabled:B,children:B?"Locking...":"Next Attempt"})]})})]}),eP&&!eC&&(0,a.jsx)("button",{className:"action-btn",onClick:eJ,disabled:z,children:z?"Finalizing...":r?"Finalize (demo)":"Finalize Round"}),(eC||eP)&&(0,a.jsx)("button",{className:"action-btn",onClick:eq,disabled:z,children:z?"Creating...":r?"Restart Demo Round":"Create New Round"}),M&&(0,a.jsx)("div",{className:"drawer-backdrop",onClick:()=>C(!1),children:(0,a.jsxs)("div",{className:"drawer",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"drawer-header",children:[(0,a.jsx)("h3",{children:"Standings"}),(0,a.jsx)("button",{className:"drawer-close",onClick:()=>C(!1),children:"Close"})]}),0===l.length?(0,a.jsx)("p",{style:{color:"var(--muted)"},children:"No players yet"}):(0,a.jsx)("ul",{className:"leaderboard",children:l.map((e,n)=>{let r;return(0,a.jsxs)("li",{children:[(0,a.jsxs)("span",{className:"rank",children:["#",n+1]}),(0,a.jsx)("span",{className:"addr",children:e.address.toLowerCase()===t.toLowerCase()?"You":(r=e.address,"".concat(r.slice(0,6),"...").concat(r.slice(-4)))}),(0,a.jsx)("span",{className:"score",children:e.score.toString()})]},e.address)})}),(0,a.jsxs)("div",{className:"status",style:{marginTop:10},children:["Attempt score: ",E.toString()," • Attempts used: ",I,"/",3]}),!r&&(0,a.jsx)("div",{className:"status",style:{marginTop:6},children:"Batched commits every ~3s (or when distance builds up). No per-action tx spam."})]})})]})}function w(){let{address:e,isConnected:t}=(0,r.F)(),{connect:n}=(0,i.e)(),{disconnect:u}=(0,s.u)();return(0,a.jsxs)("div",{className:"container",children:[(0,a.jsxs)("header",{className:"header",children:[(0,a.jsx)("h1",{children:"MegaRally"}),t?(0,a.jsxs)("button",{className:"connect-btn",onClick:()=>u(),children:[null==e?void 0:e.slice(0,6),"...",null==e?void 0:e.slice(-4)]}):(0,a.jsx)("button",{className:"connect-btn",onClick:()=>n({connector:(0,l.b)()}),children:"Connect"})]}),t?(0,a.jsx)(v,{address:e,demo:!1}):(0,a.jsx)("div",{className:"no-round",children:(0,a.jsx)("p",{children:"Connect your wallet to play"})})]})}},7207:(e,t,n)=>{Promise.resolve().then(n.bind(n,5642))}},e=>{e.O(0,[496,109,441,255,358],()=>e(e.s=7207)),_N_E=e.O()}]);